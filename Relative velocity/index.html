<!DOCTYPE html>
<html lang="en">
<head>
  <title>Relative Velocity</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/font-awesome.min.css">
  <link rel="stylesheet" href="css/bootstrap.css">
  <script src="js/jquery.min.js"></script>
  <script src="js/bootstrap.min.js"></script>  
</head>

<body style="background-image: url('images/left_bg.jpg')">
	<div class="container">
		<div class = "page-header" height="100px" width="1000px" style="background-image: url('images/back_all.jpg')">
			<br>
			<center>
				<font face="chiller">
					<h1 style="color:#00ccff"><b>RELATIVE &nbsp VELOCITY </b>
					</h1>
				</font>
			</center>
			</br>
		</div>
	<div class="navbar navbar-inverse">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle"  data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>
		<div class="collapse navbar-collapse" style="background-image: url('images/button.jpg');" >
			  <ul class="nav navbar-nav" style="float:left;">
				<li id="optionchhg">
					<a>
						<button class="btn btn-success"  data-toggle="modal" data-target="#popup" onclick="confirmbtnshow();" style="background-image: url('images/button.jpg')"  >One object moving 
						</button>
					</a>
				</li>
				
				<li id="swap">
					<a>
						<button class="btn btn-success" data-toggle="modal" onclick="setflag()" style="background-image: url('images/button.jpg')"  >Switch to two object
						</button>
					</a>
				</li>
				<li id="showanimatebtn">
				</li>
				<li>
					<a id="menu">
					</a>
				</li>
				</ul>
				<ul class="nav navbar-nav" style="float:right;">
				<li>
					<a>
						<button class="btn btn-success" data-toggle="modal" data-target="#show_instruction" style="background-image: url('images/button.jpg')"  >Instruction 
						</button>
					</a>
				</li>
			  </ul>
		</div>
	</div>
	<div class="row">
        <div class="col-md-4">	<p id="button"></p>
		</div>
	</div >	
	<div id="canvschng">
		<canvas id="myCanvas" height="400px" width="1100px" class="img-responsive" style="background-image: url('images/canvas1.gif')"   >
		</canvas>
	</div> 
	
	</br>
	<div id="resul">
	</div> 
	<script>
	var flag=1;//one for case 1 two for case 2
	//case 1 varibles
	var vo;// object  
	var rvo;// relativity of velocity 
	var rvog;// relative velocity of object relative to ground 
	var rvor;// relative velocity of object relative to river 
	var deg;//degree that given by user
	var edeg;//degree value of relative to earth,river
	var cdeg;//degree to draw curve
	var vr;//velocity of river 
	var wr;//width of river
	var ct;//crossing time
	var cd;//crossing distance
	var dd;// distance of go down to the river
	var dd2;// distance of go up to the river
	
	var tvo1;//temp velocity for animation
	var tvo2;//temp velocity for animation
	var c;//counter for animation
	var sh=400;//canvas height
	var r_deg;//radius of radian
	var angleInDegrees=180;//drawing arrow in case 1
	
	
	//case 2 varibles
	var b1v;//object 1 velocity
	var b1v;//object 2 velocity
	var b1deg;//object 1 bearing
	var b2deg;//object 2 bearing
	var dist;//distance between object
	var distdeg;//bearing of object 2 relative to object 1
	var b1rv;//object 1 relative velocity
	var b2rv;//object 2 relative velocity
	var tdeg;//object relative velocity degree
	var shortd;//shortest distance if available
	var time;//time taken to obtain shortest distance
	var bd1;//distance  from start position of object 1 when shortest distance 
	var bd2;//distance from start position  object 1 when shortest distance
	var b1deg2;//bearing of object 1 when shortest distance 
	var b2deg2;//bearing of object 2 when shortest distance 
	var angleInDegrees2=180;//drawing arrow in case 2 first object
	var angleInDegrees3=180;//drawing arrow in case 2 second object
	var type;//"M" for meet "S" for shortest distance "N" for no shortest distance
	
	//for drawings 
	var tvb1n;
	var tvb1e;
	var tvb2n;
	var tvb2e;
	var pix=100;//minimum pixels between objects
	var reldist1;//relative distance when shortest available
	var reldist2;//relative distance when shortest available
	var state=1;
	

	//switch between case 1 and case 2
	function setflag()
	{
		
			if(flag==1)
			{
				flag=2;
				document.getElementById("canvschng").innerHTML='<canvas id="myCanvas2" height="400px" width="1100px" class="img-responsive"   style="background-image: url(\'images/canvas2.jpg\')"  ></canvas> </div> ';
				document.getElementById("optionchhg").innerHTML='<a><button class="btn btn-success"  data-toggle="modal" data-target="#popup2" onclick="confirmbtnshow();stop();" style="background-image: url(\'images/button.jpg\')"  >Two object moving </button></a>';
				document.getElementById("swap").innerHTML='<a><button class="btn btn-success" data-toggle="modal" onclick="setflag()" style="background-image: url(\'images/button.jpg\')"  >Switch to one object</button></a>';
				animatehide();
				state=1;
				case2();
			
			}
		else 
			{
				flag=1;
				document.getElementById("canvschng").innerHTML='<canvas id="myCanvas" height="400px" width="1100px" class="img-responsive"   style="background-image: url(\'images/canvas1.gif\')"  ></canvas> </div> ';
				document.getElementById("optionchhg").innerHTML='<a><button class="btn btn-success"  data-toggle="modal" data-target="#popup" onclick="confirmbtnshow();" style="background-image: url(\'images/button.jpg\')" >One object moving </button></a>';
				document.getElementById("swap").innerHTML='<a><button class="btn btn-success" data-toggle="modal" onclick="setflag();" style="background-image: url(\'images/button.jpg\')"  >Switch to two object</button></a>';
				animatehide();
				case1();
				chng();
				
			}
	}
	
	
	
	//case1 
function case1()
{	
	
	
	//set canvas to animate
		var canvas = document.getElementById('myCanvas');
		var context = canvas.getContext('2d');
		//object position
		var x=document.getElementById('myCanvas').width/2;
		var y=document.getElementById('myCanvas').height;
		var ob  = 
			{
			X : x,
			Y : y
			};
		
		//draw the object
	this.drawObject=function(ob,context,col)
	{
	/* to draw a rectangle
	context.beginPath();
	context.rect(ob.X,ob.Y,10,10);
	context.fillStyle = col;//'#ff0000'
	context.fill();
	*/
	context.beginPath();
	
	context.moveTo(ob.X-5,ob.Y);
	context.lineTo(ob.X+5,ob.Y);
	context.lineTo(ob.X+8,ob.Y-10);
	context.lineTo(ob.X-8,ob.Y-10);
	
	context.moveTo(ob.X-5,ob.Y-10);
	context.lineTo(ob.X+5,ob.Y-10);
	context.lineTo(ob.X,ob.Y-15);
	
	
	context.fillStyle = col;//'#ff0000'
	context.fill();
	}
		
		
		
		
		
		
			
		this.arrow=function (){	
		$(function(){
		var canvas=document.getElementById("myCanvas");
		var isDragging=false;
		var ctx=canvas.getContext("2d");


		var image=document.createElement("img");
		image.onload=function(){
		image.width=10;
		image.height=10;
		drawRotated(angleInDegrees)
		}

		if(document.getElementById("rvo").value==1)image.src="images/ar1.png";
		else image.src="images/ar2.png";

		$("#myCanvas").mouseup(function(e){handleMouseUp(e);});
		$("#myCanvas").mousedown(function(e){handleMouseDown(e);});
		$("#myCanvas").mousemove(function(e){handleMouseMove(e);});


		function handleMouseDown(e){
		  isDragging=true;
		  
		}
		
		function handleMouseUp(e){
		  isDragging=false;
		}
		
		function handleMouseMove(e){
		//var coords = "X coords: " + x + ", Y coords: " + y;
		//document.getElementById("demo").innerHTML = coords;
		if(isDragging){
	  
		//var x = event.clientX;
		//var y = event.clientY;
		var rect = canvas.getBoundingClientRect();
		
	
		//var canvasOffset=$("#myCanvas").offset();
		//var offsetX=canvasOffset.left;
		//var offsetY=canvasOffset.top;
		var x = parseInt(e.clientX-rect.left);
		var y = parseInt(e.clientY-rect.top);
		
		
		
		if((x>450 && x<650)&&(y<canvas.height && y>canvas.height-100))
				{
				if(x<550)angleInDegrees=90+(Math.atan((y-canvas.height)/(x-550)))/(Math.PI/180);
				else angleInDegrees=180-(Math.atan((x-550)/(y-canvas.height)))/(Math.PI/180);
			
				var coords =270-angleInDegrees;
				document.getElementById("deg").value=Math.round(coords);
				drawRotated(angleInDegrees);
				}
			
			}
		}




			function drawRotated(degrees){
				ctx.clearRect(500,canvas.height-50,100,100);
				ctx.save();
				ctx.translate(550  ,sh ,10,50);
				ctx.rotate(degrees*Math.PI/180);
				ctx.drawImage(image,-image.width/2 ,-image.height/2 ,10,50);
				//ctx.moveTo(750,400);
				//ctx.bezierCurveTo(750,sh,550+(r_deg*Math.cos((Math.PI*cdeg)/360)),sh-(r_deg*Math.sin((Math.PI*cdeg)/360)),550+(r_deg*Math.cos((Math.PI*cdeg)/180)),sh-(r_deg*Math.sin((Math.PI*cdeg)/180)))
				ctx.restore();	
				context.beginPath();
				
				context.moveTo(ob.X-5,ob.Y);
				context.lineTo(ob.X+5,ob.Y);
				context.lineTo(ob.X+8,ob.Y-10);
				context.lineTo(ob.X-8,ob.Y-10);
				
				context.moveTo(ob.X-5,ob.Y-10);
				context.lineTo(ob.X+5,ob.Y-10);
				context.lineTo(ob.X,ob.Y-15);
			
			
				context.fillStyle = '#ff0000';//'#ff0000'
				context.fill();
				
				context.beginPath();
				context.moveTo(600,canvas.height);///if curve not correct set y=400
				var angl=document.getElementById("deg").value;
				context.bezierCurveTo(600,canvas.height,550+(50*Math.cos((Math.PI*(angl))/360)),canvas.height-(50)*Math.sin((Math.PI*(angl))/360),550+(50*Math.cos((Math.PI*(angl))/180)),canvas.height-(50)*Math.sin((Math.PI*(angl))/180));
				context.stroke();
				context.font = "15px Arial";
				context.strokeText(angl,530+(40*Math.cos((Math.PI*(angl))/360)),canvas.height-(30)*Math.sin((Math.PI*(angl))/360));

			}
		});
	}
	
			this.arrowchng=function()
			{
				var ang=document.getElementById("deg").value;
				if(ang !=null)angleInDegrees=270-ang;
				else angleInDegrees=180;
				arrow();
				
			}
	
	
			this.cal=function()
			{
				vo=parseFloat(document.getElementById("vo").value);
				rvo=parseFloat(document.getElementById("rvo").value);
				deg=parseFloat(document.getElementById("deg").value);

				vr=parseFloat(document.getElementById("vr").value);
				wr=parseFloat(document.getElementById("wr").value);
				 
				var vo1=(vo*Math.sin(Math.PI*deg/180));
				
				var vo2=(vo*Math.cos(Math.PI*deg/180));
	//alert(vo+" "+deg+" "+vr+" "+wr);
				if(rvo==1)
				{
				
				rvog=(Math.sqrt((vo1*vo1)+((vr+vo2)*(vr+vo2)))).toFixed(4);
				edeg=Math.round(((Math.atan((vo1)/(vr+vo2)))/(Math.PI/180)));
				cdeg=edeg;
				//alert(edeg);
				//alert(vo1+" "+vo2);
				ct=(wr/(vo*Math.sin(Math.PI*deg/180))).toFixed(4);
				//dd=Math.round((wr/(vo*Math.sin(Math.PI*deg/180)))*(vr+vo*Math.cos(Math.PI*deg/180)));
				//alert(vo2+" "+vr);
				var t= vr;
				dd=(ct*(vo2+t)).toFixed(4);
				//alert(ct+"\n"+dd);
				//alert(t);
				//document.getElementById("data").innerHTML=a+" "+b+" "+c+" "+d;
				
				
				tvo1=vo1;
				tvo2=vo2+vr;
				}
				else if(rvo==2)
				{
				rvor=(Math.sqrt((vo1*vo1)+((vo2-vr)*(vo2-vr)))).toFixed(4);
				edeg=Math.round(((Math.atan((vo1)/(vo2-vr)))/(Math.PI/180)));
				cdeg=deg;
				ct=(wr/vo1).toFixed(4);
				dd=(vo2*ct).toFixed(4);
				rvog=vo;
				tvo1=vo1;
				tvo2=vo2;
				
				//alert(rvor+" "+edeg+" "+" "+ct+" "+dd);
				}
				
				if(tvo1>tvo2)
				{
					while(tvo1>5)
					{
						tvo1=tvo1/10;
						tvo2=tvo2/10;
					}
					
				}
			else{
					while(tvo2>5)
					{
					tvo1=tvo1/10;
					tvo2=tvo2/10;
					}
				}
	
			c=(1000*ct*tvo1)/(wr);
	
			chng();cl();reset();showdata();move();arrow();ruler();
	
	}


		
			this.reset=function()
			{
				drawObject(ob,context,'#d0dee0');
				ob.X=x;
				ob.Y=y;
			}
		
		
			
			this.cl=function()
			{
				ob.X=document.getElementById('myCanvas').width/2;
				x=ob.X;
				ob.Y=document.getElementById('myCanvas').height;
				y=ob.Y;
				drawObject(ob,context);
				var options=document.getElementById("resul");
			}
			
			//draw object 
			arrow();//draw arrow and object initially
			drawObject(ob,context,'#ff0000');
			
			//animate 
			
			this.move=function(){
			//drawObject(ob,context,'#d0dee0');//clear object
			drawObject(ob,context,'#00ccff');
			ob.X=ob.X+tvo2;
			ob.Y=ob.Y-tvo1;
			
			drawObject(ob,context,'#ff0000');
			
			//if object reach to corners stop object
			
			if(ob.X>=1085 || ob.Y<=15 ||ob.X<=10)
			{stop();return;}
			
			
			animate = setTimeout(move,c); // call movein 
			}
			
		//stop animation		
			this.stop=function(){
			clearTimeout(animate);
			showdata();
			arrow();
			}
		
			this.ruler=function()
			{
			var canvas = document.getElementById("myCanvas");
			var ctx2 = canvas.getContext("2d");
			ctx2.beginPath();
				for(var i=300;i<canvas.width-50;i++)
				{
					var y=(i%50==0)?10:0;
					ctx2.moveTo(i,y);
					ctx2.lineTo(i,5);
					
					var x=((i-300)%50==0)?0:10;
					ctx2.moveTo(x+1080,i-300);
					ctx2.lineTo(1095,i-300);
				}
				ctx2.moveTo(550,400);
				ctx2.lineTo(550,0);
				ctx2.stroke();
		
				var c=document.getElementById("myCanvas");
				var ctx=c.getContext("2d");
				ctx.beginPath();
				ctx.moveTo(750,400);///if curve not correct set y=400
				
				ctx.bezierCurveTo(750,sh,550+(r_deg*Math.cos((Math.PI*cdeg)/360)),sh-(r_deg*Math.sin((Math.PI*cdeg)/360)),550+(r_deg*Math.cos((Math.PI*cdeg)/180)),sh-(r_deg*Math.sin((Math.PI*cdeg)/180)))
				
				ctx.stroke();
		}
		
			this.showdata=function() // show results
		{
		
			if(sh==100)r_deg=50;
			else r_deg=200;
			var canvas = document.getElementById("myCanvas");
			var ctx = canvas.getContext("2d");
			ctx.font = "15px Arial";
			var scaleval=((wr*550)/(sh*11)).toFixed(3);
			var scalevalheigh=((wr*100)/(sh*2)).toFixed(3);
			
			
			var str="";
			str=""+scaleval;
			ctx.strokeText("scaler "+str,800,40);
			
			str=scalevalheigh;
			ctx.strokeText(str,1000,sh/2);
				if(rvo==1)
				{
				str='Velocity Relative To Ground : '
				+rvog+' ms-1';
				
				}
				else{
				str='Velocity Relative To River : '
				+rvor+' ms-1';
				}
    
				ctx.strokeText(str,0,75);
    
				if(dd<0)dd2=-dd;
				else dd2=dd;
		
		if(rvo==1)
		{
			if(edeg>=0)
			{
				str ='Degree relative to ground: '
				+edeg;
				ctx.strokeText(edeg,550+(r_deg*Math.cos((Math.PI*cdeg)/360)),sh-(r_deg*Math.sin((Math.PI*cdeg)/360)));
			}
			else{
			cdeg=180+cdeg;
			str ='Degree Relative to ground: '
				+(180+edeg);
				ctx.strokeText(180+edeg,550+(r_deg*Math.cos((Math.PI*(180+edeg))/360)),sh-(r_deg*Math.sin((Math.PI*(180+edeg))/360)));
			}
		}
		else
		{
		if(edeg>=0)
			{
				str ='Degree relative to river: '
				+edeg;
				ctx.strokeText(deg,550+(r_deg*Math.cos((Math.PI*cdeg)/360)),sh-(r_deg*Math.sin((Math.PI*cdeg)/360)));
			}
			else{
			str ='Degree Relative to river: '
				+(180+edeg);
				ctx.strokeText(deg,550+(r_deg*Math.cos((Math.PI*cdeg)/360)),sh-(r_deg*Math.sin((Math.PI*cdeg)/360)));
			}
		}
		ctx.strokeText(str,0,60);
    
		
		str='Time to reach other end : '
		+ct+' s';
		ctx.strokeText(str,0,45);
		
		str='Distance of object  from opposite end of starting : '
		+dd2+' m';
		ctx.strokeText(str,0,30);
		
		str='Distance object swim : '
		+rvog*ct+' m';
		ctx.strokeText(str,0,15);
	
		str="width "+wr+" m";
		ctx.strokeText(str,450,sh/2);
	
    }
		//show confirm button to confirm data
		this.confirmbtnshow=function()
		{

				var options = document.getElementById("btn");
				 options.innerHTML = ' <button id="confirmbtn" class="btn btn-success"  >CONFIRM</button>';

		}
		//show submit button if entered data is confirmed
		this.submitbtnshow=function()
		{

				var options = document.getElementById("btn");
				 options.innerHTML = ' <button id="submitbtn" type="submit" class="btn btn-success"  data-dismiss="modal" onclick="(new case1()).animateshow()">OK</button>';

		}
	
			this.chng=function()
			{
			
			var edeg1;
			if(rvo==2)
			{
				edeg1=deg;
				
			}else
			{
				edeg1=edeg;
				if(edeg<0)edeg1=180+edeg;
			}
				if(((edeg1)>10.3 && (edeg1)<36.02732) || ((edeg1)>(180-36.02732) && (edeg1)<(180-10.3)))
				{
					document.getElementById('myCanvas').height =100;
					c=(wr*c)/100;
					sh=100;
				}else
				{
					document.getElementById('myCanvas').height =400;
					c=(wr*c)/400;
					sh=400;
				}
		}
	
		this.animateshow=function()
		{
		document.getElementById("showanimatebtn").innerHTML='<a><button class="btn btn-success"  data-toggle="modal" style="background-image: url(\'images/button.jpg\')" onclick="(new case1()).cal();">Show result </button></a>';
		}
		this.animatehide=function()
		{
		document.getElementById("showanimatebtn").innerHTML="";
		}
	
	}
	
	 case1();
	 //case 1 ends here(one object moving)

	 
	 function case2()
	{

		var canvas = document.getElementById('myCanvas2');
		var context = canvas.getContext('2d');
	  
	
		//object position
		var x1=document.getElementById('myCanvas2').width/2 -100;
		var x2=document.getElementById('myCanvas2').width/2 +100;
		var y1=document.getElementById('myCanvas2').height/2;
		var y2=document.getElementById('myCanvas2').height/2;
		
		var b1  = 
		{
		X : x1,
		Y : y1,
		A :180,
		N :"1",
		C :'#ff0000'
		};
		
		var b2  = 
		{
		X : x2,
		Y : y2,
		A :180,
		N :"2",
		C :'#ddff00'
		};
		
		var b5  = 
		{
		X : x1,
		Y : y1,
		A :180,
		N :"5",
		C :'#ff0000'
		};
		
		var b6  = 
		{
		X : x2,
		Y : y2,
		A :180,
		N :"6",
		C :'#ddff00'
		};
		
		
		
		
		//alert(b1.X+" "+b1.Y);
		//alert(b2.X+" "+b2.Y);
		
		this.drawObject=function(ob,context,col)
			{
			context.beginPath();
			
			context.moveTo(ob.X-5,ob.Y);
			context.lineTo(ob.X+5,ob.Y);
			context.lineTo(ob.X+8,ob.Y-10);
			context.lineTo(ob.X-8,ob.Y-10);
			
			context.moveTo(ob.X-5,ob.Y-10);
			context.lineTo(ob.X+5,ob.Y-10);
			context.lineTo(ob.X,ob.Y-15);
			
			
			context.fillStyle = col;//'#ff0000'
			context.fill();
			//context.clearRect(ob.X-30,ob.Y-10,20,10);
			//context.font = "15px Arial";
			//context.strokeText("ob"+ob.N,ob.X-30,ob.Y);
			}
			
			
			
			
			
			this.arrow=function (a,bb){	
					$(function(){
					var canvas=document.getElementById("myCanvas2");
					var isDragging=false;
					var ctx=canvas.getContext("2d");


					var image=document.createElement("img");
					image.onload=function(){
					image.width=10;
					image.height=10;
					drawRotated(a,bb)
					}

					 image.src="images/ar2.png";

					$("#myCanvas2").mouseup(function(e){handleMouseUp(e);});
					$("#myCanvas2").mousedown(function(e){handleMouseDown(e);});
					$("#myCanvas2").mousemove(function(e){handleMouseMove(e);});


				function handleMouseDown(e){
					
				  isDragging=true;
				  
				}
				
				function handleMouseUp(e){
				  isDragging=false;
				}
			
				function handleMouseMove(e){
				if(isDragging && (state==1) && (bb.N=="1" || bb.N=="2")){
			  
				var rect = canvas.getBoundingClientRect();
		  
				var xc = parseInt(e.clientX-rect.left);
				var yc = parseInt(e.clientY-rect.top);
				if((xc>bb.X-50 && xc<bb.X+50)&&(yc<bb.Y+50 && yc>bb.Y -50) )
					{
					if(xc<=bb.X && yc<=bb.Y)
						{
						bb.A=90+(Math.atan((bb.Y -yc)/(bb.X-xc)))/(Math.PI/180);//nw
						
						}
					
					else if(xc>bb.X && yc<bb.Y)
						{
						bb.A=180-(Math.atan((xc-bb.X)/(yc-bb.Y)))/(Math.PI/180);//ne
						}
					else if(xc<=bb.X && yc>=bb.Y)
						{
						bb.A=90+(Math.atan((bb.Y -yc)/(bb.X-xc)))/(Math.PI/180);//sw
						}
					else  
						{
						bb.A=360-(Math.atan((xc-bb.X)/(yc-bb.Y)))/(Math.PI/180);//se
						}
					
					
				var tempangl=bb.A;
				if(tempangl>=180 )tempangl=tempangl-180;
				else tempangl=180+tempangl;
				//drawObject(b1,context,'#ff0000');
				//drawObject(b2,context,'#ff0000');
				drawRotated(bb.A,bb);
				
				context.font = "15px Arial";
				context.strokeText(Math.round(tempangl),bb.X,bb.Y);
				if(bb.N=="1")
				{
					
					document.getElementById("b1deg").value=Math.round(tempangl);
				}
				else if(bb.N=="2")
				{
				
				document.getElementById("b2deg").value=Math.round(tempangl);
				}
					
					
			}
					
			}
		}


			function drawRotated(degrees,bb){
				ctx.clearRect(bb.X-50,bb.Y-50,100,100);

				ctx.save();
				ctx.translate(bb.X,bb.Y,10,50);
				ctx.rotate(degrees*Math.PI/180);
				ctx.drawImage(image,-image.width/2 ,-image.height/2 ,10,50);
				ctx.restore();
				drawObject(bb,ctx,bb.C);
					
				}
			});
	}

	
			//drawObject(b1,context,'#ff0000');
			//drawObject(b2,context,'#ff0000');
			//alert(b1.X);
			arrow(b2.A,b2);
			arrow(b1.A,b1);

			//cval.arrow(b2);

			this.caldata=function() //to cal for case 2
			{
			
			b1v=parseFloat(document.getElementById("b1v").value);
			b2v=parseFloat(document.getElementById("b2v").value);
			b1deg=parseFloat(document.getElementById("b1deg").value);
			b2deg=parseFloat(document.getElementById("b2deg").value);
			dist=parseFloat(document.getElementById("dist").value);
			distdeg=parseFloat(document.getElementById("distdeg").value);
			//alert("alert1"+b1v+" a"+b1deg+" "+b2v+" a"+b2deg+" "+dist+" a"+distdeg);
			
			
			var vn1=(b1v*Math.cos((Math.PI*b1deg)/180)).toFixed(3);//boat 1 north
			var ve1=(b1v*Math.sin((Math.PI*b1deg)/180)).toFixed(3);//boat 1 east
			
			var vn2=(b2v*Math.cos((Math.PI*b2deg)/180)).toFixed(3);//boat 2 north
			var ve2=(b2v*Math.sin((Math.PI*b2deg)/180)).toFixed(3);//boat 2 east
			
			tvb1n=vn1;//to drawings
			tvb1e=ve1;
			tvb2n=vn2;
			tvb2e=ve2;
			
			//alert("alert2 "+vn1+" "+ve1+" "+vn2+" "+ve2);
			//b1rv=(Math.sqrt((vn1+vn2)*(vn1+vn2)+(ve1+ve2)*(ve1+ve2))).toFixed(4);
			b2rv=(Math.sqrt((vn2-vn1)*(vn2-vn1)+(ve2-ve1)*(ve2-ve1))).toFixed(4);
			
			
			
			 tdeg=Math.round((Math.atan((ve2-ve1)/(vn2-vn1)))/(Math.PI/180));
			//alert(" alet1 "+tdeg);
			if((ve2-ve1)==0 && (vn2-vn1)==0) tdeg=distdeg;//
			else if((vn2-vn1)==0 && (ve2-ve1)<0){tdeg=270;/*alert(" nn1");*/}
			else if((ve2-ve1)==0 && (vn2-vn1)<0){tdeg=180;/*alert(" nn2");*/}
			else if((vn2-vn1)<0 ){tdeg=180+tdeg;/*alert(" nn3");*/}
			else if((ve2-ve1)<0){tdeg=360+tdeg;/*alert(" nn4");*/}
			
			//alert(" alet1 "+tdeg);
			//alert(" alet2 "+distdeg);
			//alert(" alet3 "+Math.abs(b1deg-tdeg));
			if(Math.round(b2rv)==0){type="N";}
			else
			{
				if(Math.abs(distdeg-tdeg)==180)
				{
				time=(dist/b2rv).toFixed(3);
				type="M";
				bd1=(dist/b2rv)*b1v;
				bd2=(dist/b2rv)*b2v;
				alert("meet"+time+"d1 "+bd1+"d2 "+bd2+" "+b2rv);
				}
				else
				{
					if(distdeg<=90 )
					{
						if( (tdeg <=180 && tdeg>=0))
						{
							if(tdeg<=90+distdeg)
							{
							type="N";
							//alert("no short1");
							}
							else{
							//alert("short 1");
							type="S";
							}
						}
						else
						{
							if(tdeg>=270+distdeg)
							{
							type="N";
							//alert("no short2");
							}
							else{
							//alert("short 2");
							type="S";
							}
						}
					
					}
					
					else if(distdeg<=270)
					{
						if( (tdeg <=180 && tdeg>=0))
						{
							if((tdeg>=distdeg-90) &&(tdeg<=180))
							{
							type="N";
							//alert("no short3");
							}
							else{
							//alert("short 3");
							type="S";
							}
						}
						else
						{
							if(tdeg<=90+distdeg)
							{
							type="N";
							//alert("no short4");
							}
							else{
							//alert("short 4");
							type="S";
							}
						}
					
					}
					else 
					{
						if( (tdeg <=180 && tdeg>=0))
						{
							if((tdeg<=distdeg-270) )
							{
							type="N";
							//alert("no short5");
							}
							else{
							//alert("short 5");
							type="S";
							}
						}
						else
						{
							if(tdeg>=distdeg-90)
							{
							type="N";
							//alert("no short6");
							}
							else{
							//alert("short 6");
							type="S";
							}
						}
					}
					
					if(type=="S"){
					reldist1=dist*Math.abs(Math.sin(Math.PI*(distdeg-tdeg+180)/180));
					reldist2=dist*Math.abs(Math.cos(Math.PI*(distdeg-tdeg+180)/180));
					
					
					//alert(bd2+" "+bd1);
					time=(reldist2/b2rv).toFixed(3);
					bd1=b1v*time;
					bd2=b2v*time;
					alert("shortest"+time+"d1 "+bd1+"d2 "+bd2+" "+reldist1);
					
							}
					
					/*if((distdeg<=90 && ((tdeg <=90+distdeg))) || (distdeg<=90 &&(tdeg=>270+distdeg)))
					{
					type="N1";
					alert("ns1");
					}
					else if(distdeg<=270 && ((tdeg <90+distdeg) &&(tdeg>distdeg-90)))
					{
					type="N2";
					}
					else if(distdeg<360 && ((tdeg <distdeg-270) ||(tdeg>distdeg-90)))
					{
					type="N3";
					}
					else
					{
					type="S";
					alert("S");
					}*/
					
					
				}
				
			}
			//alert(type);
			
			//alert(Math.atan(1/0)/(Math.PI/180));
			
			//alert(tdeg);
			
			//context.clearRect(0,0,canvas.width,canvas.height);
			//alert(distdeg);
			//b2.X=b1.X+dist*Math.sin((Math.PI*distdeg)/180);
			//b2.Y=b1.Y-dist*Math.cos((Math.PI*distdeg)/180);
			//alert(b2.X+" "+b2.Y+" "+b1.X+" "+b1.Y);
			//arrow(angleInDegrees3,b2);
			//arrow(angleInDegrees2,b1);
			taketostart();
			setvariables();
			
			
			}
			
			
			this.setvariables=function()
			{
			//alert("d1  "+tvb1n+" "+tvb2n+" "+tvb1e+" "+tvb2e);
			var m=Math.abs(tvb1n);
			//alert("max1 "+m);
			if(m<Math.abs(tvb1e)){m=Math.abs(tvb1e);}
			if(m<Math.abs(tvb2n)){m=Math.abs(tvb2n);}
			if(m<Math.abs(tvb2e)){m=Math.abs(tvb2e);}
			
			//alert("max2 "+m);
			while(m>5)
			{
				m=m/10.0;
				tvb1n=tvb1n/10.0;
				tvb1e=tvb1e/10.0;
				tvb2n=tvb2n/10.0;
				tvb2e=tvb2e/10.0;
			}
			//alert("d"+tvb1n+" "+tvb2n+" "+tvb1e+" "+tvb2e);
			//alert("max"+m);
			//drawObject(b2,context,'#00ccff');
			//drawObject(b1,context,'#00ccff');
			
			//move2();
			}
			
			
			
			this.taketostart=function()
			{
			context.clearRect(0,0,canvas.width,canvas.height);
			/*b1.X=x1;
			b1.Y=y1;
			//context.clearRect(0,0,canvas.width,canvas.height);
			b2.X=b1.X+dist*Math.sin((Math.PI*distdeg)/180);
			b2.Y=b1.Y-dist*Math.cos((Math.PI*distdeg)/180);*/
			
			if(type=="N")
			{
				b1.X=550-50*Math.sin(Math.PI*(distdeg)/180);
				b1.Y=200+50*Math.cos(Math.PI*(distdeg)/180);
				b2.X=550+50*Math.sin(Math.PI*(distdeg)/180);
				b2.Y=200-50*Math.cos(Math.PI*(distdeg)/180);
				b5.X=550-50*Math.sin(Math.PI*(distdeg)/180);
				b5.Y=200+50*Math.cos(Math.PI*(distdeg)/180);
				b6.X=550+50*Math.sin(Math.PI*(distdeg)/180);
				b6.Y=200-50*Math.cos(Math.PI*(distdeg)/180);
				
				drawObject(b1,context,b1.C);
				drawObject(b2,context,b2.C);
				alert("type "+b1.X+" "+b1.Y+" "+b2.X+" "+b2.Y);
			//drawObject(b1,context,b1.C);
			//drawObject(b2,context,b2.C);
			}
			else
			{
			
			
				
				pix=100;
			var x01=0;
			var y01=0;
			
			var x02=x01+dist*Math.sin(Math.PI*(distdeg)/180);
			var y02=y01-dist*Math.cos(Math.PI*(distdeg)/180);
			
			var x03=x02+bd2*Math.sin(Math.PI*(b2deg)/180);
			var y03=y02-bd2*Math.cos(Math.PI*(b2deg)/180);
			
			var x04=x01+bd1*Math.sin(Math.PI*(b1deg)/180);
			var y04=y01-bd1*Math.cos(Math.PI*(b1deg)/180);
			
			/*var xmin=x01;
			var xmax=x01;
			var ymin=y01;
			var ymax=y01;
			
				
			
				if(xmin>x02){xmin=x02;}
				if(xmin>x03){xmin=x03;}
				if(xmin>x04){xmin=x04;}
				
				if(ymin>y02){ymin=y02;}
				if(ymin>y03){ymin=y03;}
				if(ymin>y04){ymin=y04;}
				
				if(xmax<x02){xmax=x02;}
				if(xmax<x03){xmax=x03;}
				if(xmax<x04){xmax=x04;}
				
				if(ymax<y02){ymax=y02;}
				if(ymax<y03){ymax=y03;}
				if(ymax<y04){ymax=y04;}
				*/
				
			var xmin=Math.min(x01,x02,x03,x04);
			var xmax=Math.max(x01,x02,x03,x04);
			var ymin=Math.min(y01,y02,y03,y04);
			var ymax=Math.max(y01,y02,y03,y04);
				
				//alert("done"+x01+" "+x02+" "+x03+" "+x04+" m"+xmax+" "+xmin);
				//alert("done"+y01+" "+y02+" "+y03+" "+y04+" m"+ymax+" "+ymin);
				if(((Math.abs(xmax-xmin)/1050)<=dist/pix) &&((Math.abs(ymax-ymin)/350)<=dist/pix))
				{
					while(((Math.abs(xmax-xmin)/1050)<=dist/pix) &&((Math.abs(ymax-ymin)/350)<=dist/pix))
					{
						pix=pix+100;
						
					}
					pix=pix-100;
					alert("scaled");
					x02=x02*pix/dist; y02=y02*pix/dist;
					x01=x01*pix/dist; y01=y01*pix/dist;
					x03=x03*pix/dist; y03=y03*pix/dist;
					x04=x04*pix/dist; y04=y04*pix/dist;
					
					xmin=xmin*pix/dist; ymin=ymin*pix/dist;
					xmax=xmax*pix/dist; ymax=ymax*pix/dist;
					
					x02=25+x02-(xmin); x01=25+x01-(xmin);x03=25+x03-(xmin); x04=25+x04-(xmin);
					y02=25-ymin+y02; y01=25-ymin+y01;y03=25-ymin+y03; y04=25-ymin+y04;
					
					b1.X=x01;
					b1.Y=y01;
					b2.X=x02;
					b2.Y=y02;
					
						var b3  = 
						{
						X : x03,
						Y : y03,
						A :180,
						N :"3"
						};
						
						var b4  = 
						{
						X : x04,
						Y : y04,
						A :180,
						N :"4"
						};
						b5.X=x01;
						b5.Y=y01;
						b6.X=x02;
						b6.Y=y02;
						
					drawObject(b1,context,b1.C);
					drawObject(b2,context,b2.C);
					drawObject(b3,context,'#ff0000');
					drawObject(b4,context,'#ff0000');
					
					
				}
				else
				{
				
				
					alert("not scaled");
					x02=x02*pix/dist; y02=y02*pix/dist;
					x01=x01*pix/dist; y01=y01*pix/dist;
					x03=x03*pix/dist; y03=y03*pix/dist;
					x04=x04*pix/dist; y04=y04*pix/dist;
					
					xmin=xmin*pix/dist; ymin=ymin*pix/dist;
					xmax=xmax*pix/dist; ymax=ymax*pix/dist;
					
					x02=25+x02-(xmin); x01=25+x01-(xmin);x03=25+x03-(xmin); x04=25+x04-(xmin);
					y02=25-ymin+y02; y01=25-ymin+y01;y03=25-ymin+y03; y04=25-ymin+y04;
					
					var xmin2=x01;
					var ymin2=y01;
					
					if(x02<xmin2){xmin2=x02;}
					if(y02<ymin2){ymin2=y02;}
					var xtempval=0;
					var ytempval=0;
					if(x01>x03)
					{
					xtempval=950;
					}
					
					if(y01>y03)
					{
					ytempval=290;
					}
					x02=25+x02-(xmin2)+xtempval; x01=25+x01-(xmin2)+xtempval;x03=25+x03-(xmin2)+xtempval; x04=25+x04-(xmin2)+xtempval;
					y02=25-ymin2+y02+ytempval; y01=25-ymin2+y01+ytempval;y03=25-ymin2+y03+ytempval; y04=25-ymin2+y04+ytempval;
					
					
					
					
					
					b1.X=x01;
					b1.Y=y01;
					b2.X=x02;
					b2.Y=y02;
					
						var b3  = 
						{
						X : x03,
						Y : y03,
						A :180,
						N :"3"
						};
						
						var b4  = 
						{
						X : x04,
						Y : y04,
						A :180,
						N :"4"
						};
						b5.X=x01;
						b5.Y=y01;
						b6.X=x02;
						b6.Y=y02;
					drawObject(b1,context,b1.C);
					drawObject(b2,context,b2.C);
					drawObject(b3,context,'#ff0000');
					drawObject(b4,context,'#ff0000');
					
				
				}
				
				
				
			}
			
			
			
			}
	//caldata();
	
	
		this.move2=function(){
			state=2;
			//drawObject(b1,context,'#d0dee0');//clear object
			//drawObject(b2,context,'#d0dee0');//clear object
			drawObject(b5,context,'#00ccff');
			drawObject(b6,context,'#00ccff');
			//alert("data"+tvb1n+" "+tvb2n+" "+tvb1e+" "+tvb2e);
			b5.X=b5.X+(tvb1e);
			b5.Y=b5.Y-(tvb1n);
			
			b6.X=b6.X+(tvb2e);
			b6.Y=b6.Y-(tvb2n);
			
			drawObject(b5,context,b1.C);
			drawObject(b6,context,b2.C);
		
			//if object reach to corners stop object
			
			if(b5.X>=1085 || b5.Y<=15 ||b5.Y >390||b5.X<=10 || b6.X>=1085 || b6.Y<=15 || b6.X<=10 || b6.Y>390)
			{stop();return;}
		//	alert("in");
			
			animate = setTimeout(move2,50); // call movein 
			}
			
		//stop animation		
			this.stop=function(){
			clearTimeout(animate);
			state=1;
			drawtextdata();
			//taketostart();
			
			}
			
			this.drawtextdata=function()
			{
				var str="";
				if(type=="N")
				{
				context.font = "15px Arial";
				str="object 2 relative velocity "+b2rv;
				context.strokeText(str,0,15);
				str="object 2 relative velocity bearing "+tdeg;
				context.strokeText(str,0,30);
				}
			}
		



			this.animateshow=function()
			{
			document.getElementById("showanimatebtn").innerHTML='<a><button class="btn btn-success"  data-toggle="modal"  onclick="caldata();move2();drawtextdata();" >Show result </button></a>';
			}
			this.animatehide=function()
			{
			document.getElementById("showanimatebtn").innerHTML="";
			}
		
			//show confirm button to confirm data
			this.confirmbtnshow=function()
			{

					var options = document.getElementById("btn2");
					 options.innerHTML = ' <button id="confirmbtn" class="btn btn-success" onclick="chngarrow2();chngarrow1();" >CONFIRM</button>';

			}
		//show submit button if entered data is confirmed
			this.submitbtnshow=function()
			{

					var options = document.getElementById("btn2");
					 options.innerHTML = ' <button id="submitbtn" type="submit" class="btn btn-success"  data-dismiss="modal" onclick="animateshow();caldata();">OK</button>';

			}
		
			this.chngarrow1=function()
			{
			angleInDegrees2=parseFloat(document.getElementById("b1deg").value);
			if(angleInDegrees2>180)angleInDegrees2=angleInDegrees2-180;
			else angleInDegrees2=angleInDegrees2+180;
			arrow(angleInDegrees2,b1);
			}
		
			this.chngarrow2=function()
			{
			angleInDegrees3=parseFloat(document.getElementById("b2deg").value);
			if(angleInDegrees3>180)angleInDegrees3=angleInDegrees3-180;
			else angleInDegrees3=angleInDegrees3+180;
			arrow(angleInDegrees3,b2);
			}

	}
	
	</script>
	</div>


<div class="modal fade" id="popup"   >
    <div class="modal-dialog">
        <div class="modal-content" style="background:#cdcaca">
            <div class="modal-header">
                <button type="button" class="close"  data-dismiss="modal">
                       CLOSE
                </button>
                <h4 class="modal-title">
                    FILL THE DATA
                </h4>
            </div>
            <div class="modal-body">
                <form   id="form" method="post" name="form"  onsubmit="(new case1()).submitbtnshow();return false;">
                  <div class="form-group">
						<label for="vo">VELOCITY OF OBJECT (ms<sup>-1</sup>)
						</label>
                      <input type="number"  class="form-control" id="vo"  min="10" onclick="confirmbtnshow();animatehide();"  required/>
                  </div>
				  
				  <div class="form-group">
					<label for="rvo">RELATIVE TO</label>
					<select class="form-control" id="rvo">
						<option value="1">RIVER</option>
						<option value="2">GROUND</option>
					</select>
				  </div>
				  
				   <div class="form-group">
                    <label for="deg">COUNTER CLOCKWISE DEGREE FROM THE RIVER EDGE</label>
                      <input type="number"  class="form-control"
                      id="deg"  min="1" max="179" onclick="confirmbtnshow();animatehide();" onkeyup="arrowchng();" required/>
                  </div>
				  <div class="form-group">
                    <label for="vr">VELOCITY OF RIVER(ms<sup>-1</sup>)</label>
                      <input type="number"  class="form-control"
                      id="vr"  min="0"  onclick="confirmbtnshow();animatehide();" required/>
                  </div>
				  <div class="form-group">
                    <label for="wr">WIDTH OF RIVER(m)</label>
                      <input type="number"  class="form-control"
                      id="wr" min="10"  onclick="confirmbtnshow();animatehide();" required/>
                  </div>
                  <a id="btn" ></a>
                  
                </form> 
                
                
            </div>
       
        </div>
    </div>
</div>


<div class="modal fade" id="popup2"   >
    <div class="modal-dialog">
        <div class="modal-content" style="background:#cdcaca">
            <div class="modal-header">
                <button type="button" class="close" 
                   data-dismiss="modal">
                       
                       CLOSE
                </button>
                <h4 class="modal-title">
                    FILL THE DATA
                </h4>
            </div>
            
            
            <div class="modal-body">
                
               <form   id="form2" method="post" name="form"  onsubmit="submitbtnshow();return false;">
				
				<div class="form-group">
						<div class="row">
							<div class="col-md-6"> 
								<label for="b1v">VELOCITY OF OBJECT 1(ms<sup>-1</sup>)</label>
							</div>
							<div class="col-md-6">
								<label for="b1deg">BEARING</label>
							</div>
		
					</div >
					<div class="row">
						<div class="col-md-6"> 
							<input type="number"  class="form-control"
							id="b1v"  min="10" onclick="confirmbtnshow();animatehide();"  required/>
						</div>
						<div class="col-md-6">
							<input type="number"  class="form-control"
							id="b1deg"  min="0" max="360" onclick="confirmbtnshow();animatehide();" onkeyup="chngarrow1();"  required/>
						</div>

					</div >
				</div>
				
				<div class="form-group">
						<div class="row">
							<div class="col-md-6"> 
								<label for="b2v">VELOCITY OF OBJECT 2(ms<sup>-1</sup>)</label>
							</div>
							<div class="col-md-6">
								<label for="b2deg">BEARING</label>
							</div>
		
					</div >
					<div class="row">
						<div class="col-md-6"> 
							<input type="number"  class="form-control"
							id="b2v"  min="10" onclick="confirmbtnshow();animatehide();"   required/>
						</div>
						<div class="col-md-6">
							<input type="number"  class="form-control"
							id="b2deg"  min="0" max="360" onclick="confirmbtnshow();animatehide();" onkeyup="chngarrow2();"  required/>
						</div>

					</div >
				</div>
				
				<div class="form-group">
						<div class="row">
							<div class="col-md-6"> 
								<label for="dist">DISTANCE OF OBJECTS(m)</label>
							</div>
							<div class="col-md-6">
								<label for="distdeg">BEARING OF OBJECT 2 RELATIVE TO OBJECT 1 </label>
							</div>
		
					</div >
					<div class="row">
						<div class="col-md-6"> 
							<input type="number"  class="form-control"
							id="dist"  min="10" onclick="confirmbtnshow();animatehide();"   required/>
						</div>
						<div class="col-md-6">
							<input type="number"  class="form-control"
							id="distdeg"  min="0" max="360" onclick="confirmbtnshow();animatehide();"  required/>
						</div>

					</div >
				</div>
				  
                  <a id="btn2" ></a>
                </form>
            </div>
        </div>
    </div>
</div>






<div class="modal fade" id="show_instruction"   >
    <div class="modal-dialog">
        <div class="modal-content" style="background:#addaca">
            <div class="modal-header">
                <button type="button" class="close"  data-dismiss="modal">
                       CLOSE
                </button>
                <h4 class="modal-title">
                    INSTRUCTION
                </h4>
            </div>
            <div class="modal-body">
                
                <form   id="form" method="post" name="form"  onsubmit="return false;">
				
                  
				  
				  <label for="ob1" > <font size="7" color="red">Object 1</font></label><br>
				  <div class="form-group">
				  
					<center> <label for="ob1" > <font size="6" color="blue"> Initial Page </font></label><br>
                    <img src="images/img0.png" width="500" height="500"></center>
					<h4>If you  click "switch to two object" then you can change "one object moving" to "two object moving"  this "switch to two object" button use change for no 1 .</h4><br>
					
				  </div><br><br>
				  
				   <div class="form-group">
					<center> <label for="ob1"> <font size="6" color="blue"> Insert data  </font></label><br>
					<h4> After choose one object moving  you can see form to insert data .</h4>
                    <img src="images/img1.png" width="500" height="500"> <br>
					<h4> If you click "no 1" you can see this form to insert data.In this form "A" you can file or you can give value using mouse click you can see it in "B".
					After file the form click the confirm button ,shown  by "no 2".</h4>
					
					</center>
					</div><br><br>
					
					
					
				  
				   
				  
				  <div class="form-group">
				  
					<center> 
					<label for="ob1" > <font size="6" color="blue"> Object Movement </font></label><br><br>
					<h4>After confirm the form you can see "show result" button .If you click it you can see all result and object movement.</h4><br>
					<img src="images/img2.png" width="500" height="500"><br><br>
					
					</center>
                  </div><br><br>
                  
                  
                  <a id="btn" ></a>
                </form> 
                
                
            </div>
       
        </div>
    </div>
</div>
<div id="data"></div>
</body>
</html>
